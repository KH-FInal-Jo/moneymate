<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="JBoardMapper">

	<resultMap type="JBoard" id="board_rm">
	
			<id property="boardNo" column="BOARD_NO" />
	
			<result property="boardTitle" column="BOARD_TITLE" />
			<result property="boardContent" column="BOARD_CONTENT" />
			<result property="boardCreateDate" column="BOARD_DT" />
			<result property="boardUpdateDate" column="BOARD_UPDATE_DT" />
			<result property="readCount" column="READ_COUNT" />
			<result property="memberNickname" column="MEMBER_NICKNAME" />
	
			<result property="memberNo" column="MEMBER_NO" />
	</resultMap>
	
	<!-- <resultMap type="JAccountBook" id="account_rm">
	
			<id property="accountNo" column=ACNT_NO />
	
			<result property="accountMoney" column="ACNT_MN" />
	
			<result property="memberNo" column="MEMBER_NO" />
	</resultMap> -->


	<!-- 공지사항 목록 조회 -->
	<select id="selectBoardNotice" resultMap="board_rm">
		SELECT BOARD_NO,BOARD_TITLE,BOARD_CONTENT,BOARD_DT,BOARD_UPDATE_DT,
        BOARD_ST, READ_COUNT,BOARD_CODE, MEMBER_NO, MEMBER_NICKNAME
		FROM BOARD
		JOIN MEMBER USING(MEMBER_NO)
		WHERE MEMBER_NO = 2
		AND BOARD_CODE = 1
		AND BOARD_ST = 'N'
	</select>
	
	<!-- 공지사항 상세정보 조회 -->
	<select id="boardNoticeDetail" resultMap="board_rm">
		SELECT BOARD_NO,BOARD_TITLE,BOARD_CONTENT,BOARD_DT,BOARD_UPDATE_DT,
        BOARD_ST, READ_COUNT,BOARD_CODE, MEMBER_NO, MEMBER_NICKNAME
		FROM BOARD
		JOIN MEMBER USING(MEMBER_NO)
		WHERE MEMBER_NO = 2
		AND BOARD_NO = #{boardNo}
		AND BOARD_CODE = 1
		AND BOARD_ST = 'N'
	</select>
	
	<!-- 공지사항 다음 게시글 번호 얻어오기 -->
	<select id="nextBoardNo" resultType="_int">
		SELECT SEQ_BOARD_NO.NEXTVAL FROM DUAL
	</select>
	
	<!-- 공지사항 작성하기 -->
	<insert id="insertBoardNotice">
		INSERT INTO BOARD
		VALUES(#{boardNo}, #{boardTitle},#{boardContent},DEFAULT, DEFAULT, DEFAULT, DEFAULT, 1, 2)
	
	</insert>
	
	
	<!-- 가계부 다음 번호 얻어오기 -->
	<select id="nextAccountNo" resultType="_int">
		SELECT SEQ_ACNT_NO.NEXTVAL FROM DUAL
	</select>
	
	<!-- 가계부 작성하기 -->
	<insert id="accountInertInout">
		INSERT INTO ACCOUNTBOOK VALUES(SEQ_ACNT_NO.NEXTVAL, #{relevantDate}, DEFAULT, #{account}, #{accountMoney},
					 #{memo}, #{paymentMethod}, #{categoryCode}, #{memberNo}, DEFAULT, #{categoryName}, #{inoutName})
	
	</insert>
	
	<!-- <insert id="accountInertInout" >
		
		INSERT ALL
      INTO ACCOUNTBOOK VALUES (SEQ_ACNT_NO.NEXTVAL, #{relevantDate}, DEFAULT, #{account}, #{accountMoney}, #{memo},
                    #{paymentMethod}, 1, #{memberNo}, DEFAULT)
               
      INTO CATEGORY VALUES (1, #{categoryName}, 1)
      INTO INOUTTRANS VALUES (1, #{inoutName})
    SELECT *
      FROM DUAL
	
	</insert> -->
	
	<!-- 가계부 상세조회 -->
	<select id="accountUse" resultMap="account_rm">
		SELECT SUM(ACNT_MN) AS TOTAL_EXPENSE
		FROM ACCOUNTBOOK
		WHERE INOUT_CONT = '지출'
		AND MEMBER_NO = #{memberNo}
	</select>


</mapper>
